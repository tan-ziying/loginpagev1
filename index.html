<html>

<head>
	<title>Plain HTML Sandbox</title>
</head>

<body>
	<div id="app">
		<facebook-login class="button" appId="275263693320314" @login="onLogin" @logout="onLogout" @sdk-loaded="sdkLoaded">
		</facebook-login>
		<img v-if="!isConnected" :src="loginImage" class="login">
		<div v-if="isConnected" class="information">
			<h1>My Facebook Information</h1>
			<div class="well">
				<div class="list-item">
					<img :src="loginImage">
					<i>{{name}}</i>
				</div>
				<div class="list-item">
					<img :src="mailImage">
					<i>{{email}}</i>
				</div>
				<div class="list-item">
					<img :src="faceImage">
					<i>{{personalID}}</i>
				</div>
			</div>
		</div>
	</div>

	<script src="https://unpkg.com/vue"></script>
  <script src="https://unpkg.com/facebook-login-vue/dist/facebook-login.js"></script>
	<script>
	  
    
		var app = new Vue({
      el:"#app",
      data: {
       counter: 0, 
       databaseUrl: 'https://bt3103-week4.firebaseio.com/trial.json',
      },
	  mounted: function () { //Will start at zero if you don't update on init
        this.update();
      },
    methods:{
        increment: function(){
          this.counter++
          this.setRemoteCounter(this.counter)
        },
        reset: function(){
          // Post to the counter to set it to zero. 
          this.counter = 0
		      this.setRemoteCounter(this.counter)          
        },
				 setRemoteCounter: async function(newVal){ 
           // Post to the counter to set it to zero. 
           let res = await fetch(this.databaseUrl, { 
              method:'put', 
              body: JSON.stringify({'counter':newVal})
				    }) 
          let theJson = await res.json()
          console.log(theJson)
         },
        update: async function() {
          let res = await fetch(this.databaseUrl) 
          let theJson = await res.json()
          console.log("Updated remote counter",theJson)
		      if(theJson && theJson.counter) {
            console.log("here")
              this.counter = theJson.counter
          }
			      
        }
      }
    })
	</script>
</body>

</html>